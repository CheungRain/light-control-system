{"ast":null,"code":"import { ref, onMounted, onUnmounted } from 'vue';\nimport { toLogin } from '../http/index';\nexport default {\n  __name: 'LoginPage',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    let word = ref('');\n    const data = {\n      username: 'zhangsan',\n      password: '123'\n    };\n    const login = name => {\n      toLogin(data).then(res => {\n        console.log(res);\n        init(name);\n      }).catch(err => {\n        console.log(err);\n      });\n    };\n    const init = name => {\n      if (typeof WebSocket === \"undefined\") {\n        alert(\"您的浏览器不支持socket\");\n      } else {\n        const ws = new WebSocket(`ws://192.168.2.19:8080/chat/${name}`);\n        //  //连接发生错误的回调方法\n        ws.onerror = function () {\n          console.log(\"ws连接发生错误\");\n        };\n        //连接成功建立的回调方法\n        ws.onopen = function () {\n          console.log(\"ws连接成功\");\n        };\n        //接收到消息的回调方法\n        ws.onmessage = function (event) {\n          console.log(name + '的', event.data);\n        };\n        //连接关闭的回调方法\n        ws.onclose = function () {\n          console.log(\"ws连接关闭\");\n        };\n      }\n    };\n    const __returned__ = {\n      get word() {\n        return word;\n      },\n      set word(v) {\n        word = v;\n      },\n      data,\n      login,\n      init,\n      ref,\n      onMounted,\n      onUnmounted,\n      get toLogin() {\n        return toLogin;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","toLogin","word","data","username","password","login","name","then","res","console","log","init","catch","err","WebSocket","alert","ws","onerror","onopen","onmessage","event","onclose"],"sources":["D:/VUE/demo/src/pages/LoginPage.vue"],"sourcesContent":["<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue';\r\nimport {toLogin} from '../http/index'\r\n\r\nlet word = ref('')\r\nconst data = {\r\n  username:'zhangsan',\r\n  password:'123'\r\n}\r\nconst login = (name) => {\r\n  toLogin(data).then(res => {\r\n    console.log(res);\r\n    init(name)\r\n  }).catch(err => {\r\n    console.log(err);\r\n  })\r\n}\r\nconst init = (name) => {\r\n  if(typeof(WebSocket) === \"undefined\"){\r\n    alert(\"您的浏览器不支持socket\")\r\n  }else{\r\n    const ws = new WebSocket(`ws://192.168.2.19:8080/chat/${name}`)\r\n    //  //连接发生错误的回调方法\r\n    ws.onerror = function () {\r\n      console.log(\"ws连接发生错误\");\r\n    };\r\n    //连接成功建立的回调方法\r\n    ws.onopen = function () {\r\n      console.log(\"ws连接成功\");\r\n    }\r\n    //接收到消息的回调方法\r\n    ws.onmessage = function (event) {\r\n      console.log(name + '的',event.data);\r\n    }\r\n    //连接关闭的回调方法\r\n    ws.onclose = function () {\r\n      console.log(\"ws连接关闭\");\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <h1>Web Socket</h1>\r\n  <div>聊天框 <textarea type=\"text\" v-model=\"word\" ></textarea></div>\r\n  <button @click=\"login('zhangsan')\">张三登录</button>\r\n  <button @click=\"login('李四')\">李四登录</button>\r\n  <button @click=\"send\">发送</button>\r\n</template>\r\n\r\n<style scoped>\r\n</style>"],"mappings":"AACA,SAASA,GAAG,EAAEC,SAAS,EAAEC,WAAW,QAAQ,KAAK;AACjD,SAAQC,OAAO,QAAO,eAAe;;;;;;;IAErC,IAAIC,IAAI,GAAGJ,GAAG,CAAC,EAAE,CAAC;IAClB,MAAMK,IAAI,GAAG;MACXC,QAAQ,EAAC,UAAU;MACnBC,QAAQ,EAAC;IACX,CAAC;IACD,MAAMC,KAAK,GAAIC,IAAI,IAAK;MACtBN,OAAO,CAACE,IAAI,CAAC,CAACK,IAAI,CAACC,GAAG,IAAI;QACxBC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC;QAChBG,IAAI,CAACL,IAAI,CAAC;MACZ,CAAC,CAAC,CAACM,KAAK,CAACC,GAAG,IAAI;QACdJ,OAAO,CAACC,GAAG,CAACG,GAAG,CAAC;MAClB,CAAC,CAAC;IACJ,CAAC;IACD,MAAMF,IAAI,GAAIL,IAAI,IAAK;MACrB,IAAG,OAAOQ,SAAU,KAAK,WAAW,EAAC;QACnCC,KAAK,CAAC,gBAAgB,CAAC;MACzB,CAAC,MAAI;QACH,MAAMC,EAAE,GAAG,IAAIF,SAAS,CAAE,+BAA8BR,IAAK,EAAC,CAAC;QAC/D;QACAU,EAAE,CAACC,OAAO,GAAG,YAAY;UACvBR,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;QACzB,CAAC;QACD;QACAM,EAAE,CAACE,MAAM,GAAG,YAAY;UACtBT,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;QACvB,CAAC;QACD;QACAM,EAAE,CAACG,SAAS,GAAG,UAAUC,KAAK,EAAE;UAC9BX,OAAO,CAACC,GAAG,CAACJ,IAAI,GAAG,GAAG,EAACc,KAAK,CAAClB,IAAI,CAAC;QACpC,CAAC;QACD;QACAc,EAAE,CAACK,OAAO,GAAG,YAAY;UACvBZ,OAAO,CAACC,GAAG,CAAC,QAAQ,CAAC;QACvB,CAAC;MACH;IACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}